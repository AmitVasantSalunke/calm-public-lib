{
    "tasks":[
        {
            "uid":"5747ddcecba042cf888e737d",
            "classification":"provision_azure",
            "creation_time":1464327630,
            "user_data":null,
            "credential_id":"5747ea13cba042cf88c09bcb",
            "storage_type":"Standard_GRS",
            "size":"A6",
            "subnet":"Subnet-1",
            "network":"calmnet",
            "image_type":"os",
            "version":38,
            "location":"East US",
            "editables":[

            ],
            "vm_name":"Haproxy-@@{AZ_RANDOM}@@",
            "tags":{

            },
            "image_name":"03f55de797f546a1b29d1b8d66be687a__CoreCLR-x64-Beta5-Linux-PartsUnlimited-Demo-App-201504.29",
            "modification_time":1464575998,
            "name":"Provision Azure",
            "install_vm_agent":true,
            "shutdown_behavior":"delete",
            "credential_to_feed_vm":"5747ea13cba042cf88c09bcb",
            "storage_name":"cvorw3x9s0rf7bn0mkg7",
            "critical":true,
            "os_type":"Linux"
        },
        {
            "uid":"5747e1e2cba042cf855ce1c4",
            "classification":"runshell",
            "script":"#!\/bin\/bash\nsudo apt-get update -y\ncurl -L https:\/\/www.chef.io\/chef\/install.sh | sudo bash",
            "creation_time":1464328674,
            "credential_id":"5747ea13cba042cf88c09bcb",
            "modification_time":1464575998,
            "version":37,
            "critical":false,
            "editables":[

            ],
            "name":"Install_Chef-Client"
        },
        {
            "uid":"5747e1e2cba042cf855ce1c5",
            "classification":"runshell",
            "script":"#!\/bin\/bash\nsudo apt-get install build-essential curl git vim -y\nsudo mkdir -p \/var\/chef\/cache \/var\/chef\/cookbooks\nwget -qO- https:\/\/supermarket.chef.io\/cookbooks\/haproxy\/download | sudo tar xvzC \/var\/chef\/cookbooks\nsudo \/opt\/chef\/embedded\/bin\/gem install berkshelf\necho \"source 'https:\/\/api.berkshelf.com'\nmetadata\" | sudo tee \/var\/chef\/cookbooks\/haproxy\/Berksfile\nsudo \/opt\/chef\/embedded\/bin\/berks vendor \/var\/chef\/cookbooks --berksfile=\/var\/chef\/cookbooks\/haproxy\/Berksfile\necho \"cookbook_path \\\"\/var\/chef\/cookbooks\\\"\" | tee config.rb\nhosts=$(echo \"@@{HOSTS}@@\" | tr \",\" \"\\n\")\n\nhost_count=$(echo \"@@{HOSTS}@@\" | tr \",\" \"\\n\"| wc -l)\nport=@@{PORT}@@\necho \"{\n\\\"haproxy\\\": {\n  \\\"members\\\" :[\" | tee node.json\ncount=1\nfor host in $hosts\ndo\n   echo \"   {\n   \\\"hostname\\\" : \\\"host-${host}\\\",\n   \\\"ipaddress\\\" : \\\"$host\\\",\n   \\\"port\\\" : $port\n    }\" | tee -a node.json\n   if [ $count != $host_count ];then\n    echo \",\" | tee -a node.json\n   fi\n   count=$(($count+1))\ndone\necho \"]}\n}\" | tee -a node.json\necho \"cookbook_path \\\"\/var\/chef\/cookbooks\\\"\" | tee config.rb\nsudo chef-client -z -c config.rb -j node.json -o haproxy \n",
            "creation_time":1464330737,
            "credential_id":"5747ea13cba042cf88c09bcb",
            "modification_time":1464575998,
            "version":35,
            "critical":false,
            "editables":[

            ],
            "name":"Install_Haproxy"
        },
        {
            "uid":"5748143fcba042cf886ede2b",
            "classification":"runshell",
            "script":"#!\/bin\/bash\nhosts=$(echo \"@@{HOSTS}@@\" | tr \",\" \"\\n\")\nhost_count=$(echo \"@@{HOSTS}@@\" | tr \",\" \"\\n\"| wc -l)\nport=@@{PORT}@@\necho \"{\n\\\"haproxy\\\": {\n  \\\"members\\\" :[\" | tee node.json\ncount=1\nfor host in $hosts\ndo\n   echo \"   {\n   \\\"hostname\\\" : \\\"host-${host}\\\",\n   \\\"ipaddress\\\" : \\\"$host\\\",\n   \\\"port\\\" : $port\n    }\" | tee -a node.json\n   if [ $count != $host_count ];then\n    echo \",\" | tee -a node.json\n   fi\n   count=$(($count+1))\ndone\necho \"]}\n}\" | tee -a node.json\necho \"cookbook_path \\\"\/var\/chef\/cookbooks\\\"\" | tee config.rb\nsudo chef-client -z -c config.rb -j node.json -o haproxy \n",
            "creation_time":1464341568,
            "credential_id":"5747ea13cba042cf88c09bcb",
            "modification_time":1464575998,
            "version":10,
            "critical":false,
            "editables":[

            ],
            "name":"Update"
        },
        {
            "uid":"574851eecba042cf886d78bf",
            "classification":"runshell",
            "script":"#!\/bin\/bash\nwget -qO- https:\/\/supermarket.chef.io\/cookbooks\/haproxy\/download | sudo tar xvzC \/var\/chef\/cookbooks\necho \"source 'https:\/\/api.berkshelf.com'\nmetadata\" | sudo tee \/var\/chef\/cookbooks\/haproxy\/Berksfile\n\nsudo \/opt\/chef\/embedded\/bin\/berks vendor \/var\/chef\/cookbooks --berksfile=\/var\/chef\/cookbooks\/haproxy\/Berksfile",
            "creation_time":1464357359,
            "credential_id":"5747ea13cba042cf88c09bcb",
            "modification_time":1464575998,
            "version":6,
            "critical":false,
            "editables":[

            ],
            "name":"Upgrade-Cookbook"
        }
    ],
    "uid":"5747ddcecba042cf888e7381",
    "classification":"blueprint",
    "autoscale_config":{
        "post_flow":null,
        "cool_down_period":"1800",
        "uid":"5747ddcecba042cf888e73e6",
        "classification":null,
        "alert_count":"1",
        "max_count":"1",
        "pre_flow":null,
        "min_count":"1",
        "listen_for":"external",
        "scale_by":"1",
        "alert_window":"1800"
    },
    "cost":0.0,
    "strategy_enabled":false,
    "environment":"default",
    "provider":null,
    "config":{
        "setup":[

        ],
        "uid":"5747ddcecba042cf888e73e7",
        "classification":null,
        "deploy":[

        ]
    },
    "calm-version":"1.7.1",
    "description":null,
    "parent":null,
    "flows":[
        {
            "tasks":[
                {
                    "task_id":"5748143fcba042cf886ede2b",
                    "rc_id":"cid:00000001",
                    "uid":"5748143fcba042cf886ede2c",
                    "classification":null
                }
            ],
            "uid":"cid:00000002",
            "classification":null,
            "eta":-1,
            "creation_time":1464341568,
            "edges":[

            ],
            "has_critical_tasks":false,
            "modification_time":1464575998,
            "version":0,
            "flow_type":null,
            "critical":false,
            "name":"Update"
        },
        {
            "tasks":[
                {
                    "task_id":"574851eecba042cf886d78bf",
                    "rc_id":"cid:00000001",
                    "uid":"574851eecba042cf886d78c0",
                    "classification":null
                }
            ],
            "uid":"cid:00000003",
            "classification":null,
            "eta":-1,
            "creation_time":1464357339,
            "edges":[

            ],
            "has_critical_tasks":false,
            "modification_time":1464575998,
            "version":0,
            "flow_type":null,
            "critical":false,
            "name":"Upgrade"
        }
    ],
    "dependencies":[

    ],
    "credentials":[
        {
            "username":"ubuntu",
            "public_key":"-----BEGIN CERTIFICATE-----\nMIID4zCCAsugAwIBAgIJAIToAW02xaWfMA0GCSqGSIb3DQEBCwUAMIGHMQswCQYD\nVQQGEwJJTjESMBAGA1UECAwJUmFqYXN0aGFuMRIwEAYDVQQHDAlCYW5nYWxvcmUx\nDzANBgNVBAoMBkNBTE1JTzEMMAoGA1UECwwDZGV2MQ8wDQYDVQQDDAZDQUxNSU8x\nIDAeBgkqhkiG9w0BCQEWEW1hZGh1bGlrYUBjYWxtLmlvMB4XDTE2MDMxNDExNDIw\nN1oXDTE3MDMxNDExNDIwN1owgYcxCzAJBgNVBAYTAklOMRIwEAYDVQQIDAlSYWph\nc3RoYW4xEjAQBgNVBAcMCUJhbmdhbG9yZTEPMA0GA1UECgwGQ0FMTUlPMQwwCgYD\nVQQLDANkZXYxDzANBgNVBAMMBkNBTE1JTzEgMB4GCSqGSIb3DQEJARYRbWFkaHVs\naWthQGNhbG0uaW8wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCbxmb8\nrMW5da4lPX+V71loE2DJeCSfmUfYYNyWMmtPoTkxhOprgQ6xhJ3bQZrlSGmnlFIU\n6akfT0xxM1m1KkiR2ouzX0HLAgG9Z2EvM0BwoG5ow9BtB9Avvi9DYe0dSB\/rOe1L\n7ZlJ67z67GGgzzWZSjtzZNZa9BDzJe6x0s4X8CLqzqcGIGNHHxSD\/eZhyh16l2W5\ntEnXotfbscEibpaGtMnaovJBMMrqnQmio7hJX+RFWZrf9NbnOXs2t+vIxIn86LSi\nxbCuhw68YMWjkSHJ29eKVopssue2vA6456I1n7PqfKCy35kEBRdeabZHpH3mAZVc\n70sMHb4zuAvE4f8PAgMBAAGjUDBOMB0GA1UdDgQWBBQeFNLnU1TsTZhLgXR3CXH1\nDxk1tzAfBgNVHSMEGDAWgBQeFNLnU1TsTZhLgXR3CXH1Dxk1tzAMBgNVHRMEBTAD\nAQH\/MA0GCSqGSIb3DQEBCwUAA4IBAQBXWMxief6slwSPzHMSMGJ3lVeEgBsn5nDE\nx60q4KZ0cZIjSU0O9R6zGGII8u0+G8TnDTjq7J5xVNyj+Y99huoWe7L7rVwfz\/2W\noulrp9jhw9BdSDIGEDaJVIkCgQxYVwGGP9N2Yocm0PUGXd5xh2+zBVvpoLhvuKaO\n6dIOos0xW1M2P+K53v+3QVstWRPDxPO6Kj9On0vF1R9PdYxWb3Giat2rkdUNvgHM\n6cfKKoWicz1OB1bmz8VkCoq\/zPKq4Yz2lefQoeSKGZw8ekiIzVpJ87I5UHymlf6R\nJZbo65IiSnBrGXBLGOW1BBNLoMzVg6WFqIsJHpXnY2BRTfjxrlRz\n-----END CERTIFICATE-----\n",
            "uid":"5747ea13cba042cf88c09bcb",
            "classification":null,
            "secret_type":"ssh_key",
            "creation_time":1464330772,
            "modification_time":1464575998,
            "secret":null,
            "version":22,
            "name":"azure"
        }
    ],
    "bp_id":null,
    "properties":[
        {
            "uid":"57480948cba042cf850045d7",
            "classification":null,
            "editable":true,
            "value":"127.0.0.1,127.0.0.2",
            "key":"HOSTS",
            "property_description":null,
            "property_type":"EXTERNAL",
            "setter":null
        },
        {
            "uid":"57480948cba042cf850045d8",
            "classification":null,
            "editable":true,
            "value":"80",
            "key":"PORT",
            "property_description":null,
            "property_type":"EXTERNAL",
            "setter":null
        }
    ],
    "autoscale_enabled":false,
    "name":"Haproxy",
    "setup_ids":{

    },
    "h":0.0,
    "resiliency_config":{
        "post_flow":null,
        "cool_down_period":"1800",
        "alert_window":"1800",
        "classification":null,
        "alert_count":"1",
        "pre_flow":null,
        "listen_for":"internal",
        "uid":"5747ddcecba042cf888e73e8"
    },
    "resiliency_enabled":false,
    "architecture":[
        {
            "tasks":[

            ],
            "uid":"cid:00000001",
            "classification":"compute",
            "address":"@@{public_ip_address}@@",
            "credential_id":null,
            "autoscale_config":{
                "post_flow":null,
                "cool_down_period":"1800",
                "uid":"5747ddcecba042cf888e73b8",
                "classification":null,
                "alert_count":"1",
                "max_count":"1",
                "pre_flow":null,
                "min_count":"1",
                "listen_for":"external",
                "scale_by":"1",
                "alert_window":"1800"
            },
            "cost":0.0,
            "strategy_enabled":false,
            "provider":"5747ddcecba042cf888e737d",
            "service_type":"ssh",
            "config":{
                "setup":[

                ],
                "uid":"5747ddcecba042cf888e73bb",
                "classification":null,
                "deploy":[
                    "5747e1e2cba042cf855ce1c4",
                    "5747e1e2cba042cf855ce1c5"
                ]
            },
            "parent":"5747ddcecba042cf888e7381",
            "flows":[

            ],
            "dependencies":[

            ],
            "service_port":22,
            "bp_id":"5747ddcecba042cf888e7381",
            "properties":[

            ],
            "autoscale_enabled":false,
            "name":"Haproxy",
            "h":0.0,
            "resiliency_config":{
                "post_flow":null,
                "cool_down_period":"1800",
                "alert_window":"1800",
                "classification":null,
                "alert_count":"1",
                "pre_flow":null,
                "listen_for":"internal",
                "uid":"5747ddcecba042cf888e73b9"
            },
            "resiliency_enabled":false,
            "w":0.0,
            "strategy_config":{
                "post_flow":null,
                "rollback_pre_flow":null,
                "classification":null,
                "rolling_factor":"100",
                "initial_version":null,
                "approval_flag":false,
                "upgrade_flow":null,
                "rollback_flow":null,
                "pre_flow":null,
                "rollback_post_flow":null,
                "upgrade_type":"rolling_upgrade",
                "uid":"5747ddcecba042cf888e73ba",
                "users":[

                ],
                "teams":[

                ],
                "emails":[

                ],
                "initial_count":"1"
            },
            "y":107.3822479248,
            "x":-134.6036529541,
            "os_type":"Linux"
        }
    ],
    "w":0.0,
    "strategy_config":{
        "post_flow":null,
        "rollback_pre_flow":null,
        "classification":null,
        "rolling_factor":"100",
        "initial_version":null,
        "approval_flag":false,
        "upgrade_flow":null,
        "rollback_flow":null,
        "pre_flow":null,
        "rollback_post_flow":null,
        "upgrade_type":"rolling_upgrade",
        "uid":"5747ddcecba042cf888e73e9",
        "users":[

        ],
        "teams":[

        ],
        "emails":[

        ],
        "initial_count":"1"
    },
    "y":0.0,
    "x":0.0
}